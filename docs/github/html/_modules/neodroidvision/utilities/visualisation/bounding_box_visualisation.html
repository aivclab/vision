
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>neodroidvision.utilities.visualisation.bounding_box_visualisation &#8212; neodroidvision 0.2.9 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="canonical" href="Neodroid.github.io/neodroidvision/_modules/neodroidvision/utilities/visualisation/bounding_box_visualisation.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for neodroidvision.utilities.visualisation.bounding_box_visualisation</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>


<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">PIL</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageColor</span><span class="p">,</span> <span class="n">ImageDraw</span><span class="p">,</span> <span class="n">ImageFont</span>
<span class="kn">from</span> <span class="nn">attr</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">draugr.pandas_utilities</span> <span class="kn">import</span> <span class="n">ColorEnum</span>
<span class="kn">from</span> <span class="nn">draugr.visualisation.pillow_utilities</span> <span class="kn">import</span> <span class="n">PilModesEnum</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">warg</span> <span class="kn">import</span> <span class="n">Number</span>
<span class="kn">from</span> <span class="nn">warg.mixins.dict_mixins</span> <span class="kn">import</span> <span class="n">IterDictValuesMixin</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Christian Heider Nielsen&quot;</span>
<span class="vm">__doc__</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;A set of functions that are used for visualisation.</span>

<span class="s2">These functions often receive an image, perform some visualisation on the image.</span>
<span class="s2">The functions do not return a value, instead they modify the image itself.</span>

<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="BoundingBoxCoordinatesSpec"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.BoundingBoxCoordinatesSpec.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.BoundingBoxCoordinatesSpec">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BoundingBoxCoordinatesSpec</span><span class="p">(</span><span class="n">IterDictValuesMixin</span><span class="p">):</span>
    <span class="n">x_min</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y_min</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">x_max</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y_max</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">def __init__(self,x_min,y_min,x_max,y_max):</span>
<span class="sd">self.x_min = x_min</span>
<span class="sd">self.y_min = y_min</span>
<span class="sd">self.x_max = x_max</span>
<span class="sd">self.y_max = y_max</span>
<span class="sd">&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="BoundingBoxSpec"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.BoundingBoxSpec.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.BoundingBoxSpec">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BoundingBoxSpec</span><span class="p">:</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;mask&quot;</span><span class="p">,</span> <span class="s2">&quot;keypoints&quot;</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">]</span>

    <span class="n">coordinates</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">score</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">mask</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">keypoints</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>


<span class="n">_TITLE_LEFT_MARGIN</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">_TITLE_TOP_MARGIN</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">STANDARD_COLORS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;AliceBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Chartreuse&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Aqua&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Aquamarine&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Azure&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Beige&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bisque&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BlanchedAlmond&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BlueViolet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BurlyWood&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CadetBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AntiqueWhite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Chocolate&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Coral&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CornflowerBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cornsilk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Crimson&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cyan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkCyan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkGoldenRod&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkGrey&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkKhaki&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkOrange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkOrchid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkSalmon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkSeaGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkTurquoise&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DarkViolet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DeepPink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DeepSkyBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DodgerBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FireBrick&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FloralWhite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ForestGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Fuchsia&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Gainsboro&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GhostWhite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Gold&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GoldenRod&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Salmon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Tan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HoneyDew&quot;</span><span class="p">,</span>
    <span class="s2">&quot;HotPink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IndianRed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Ivory&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Khaki&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Lavender&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LavenderBlush&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LawnGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LemonChiffon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightCoral&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightCyan&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightGoldenRodYellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightGray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightGrey&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightPink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSalmon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSeaGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSkyBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSlateGray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSlateGrey&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightSteelBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LightYellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Lime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;LimeGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Linen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Magenta&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumAquaMarine&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumOrchid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumPurple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumSeaGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumSlateBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumSpringGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumTurquoise&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MediumVioletRed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MintCream&quot;</span><span class="p">,</span>
    <span class="s2">&quot;MistyRose&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Moccasin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;NavajoWhite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OldLace&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Olive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OliveDrab&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Orange&quot;</span><span class="p">,</span>
    <span class="s2">&quot;OrangeRed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Orchid&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PaleGoldenRod&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PaleGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PaleTurquoise&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PaleVioletRed&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PapayaWhip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PeachPuff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Peru&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Plum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;PowderBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Purple&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Red&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RosyBrown&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RoyalBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SaddleBrown&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SandyBrown&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SeaGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SeaShell&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sienna&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Silver&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SkyBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlateBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlateGray&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SlateGrey&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Snow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SpringGreen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SteelBlue&quot;</span><span class="p">,</span>
    <span class="s2">&quot;GreenYellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Teal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Thistle&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Tomato&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Turquoise&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Violet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Wheat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;White&quot;</span><span class="p">,</span>
    <span class="s2">&quot;WhiteSmoke&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;YellowGreen&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="encode_image_array_as_png_str"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.encode_image_array_as_png_str.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.encode_image_array_as_png_str">[docs]</a><span class="k">def</span> <span class="nf">encode_image_array_as_png_str</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Encodes a numpy array into a PNG string.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: a numpy array with shape [height, width, 3].</span>

<span class="sd">    Returns:</span>
<span class="sd">    PNG encoded image string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">six</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">image_pil</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;PNG&quot;</span><span class="p">)</span>
    <span class="n">png_string</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
    <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">png_string</span></div>


<div class="viewcode-block" id="draw_bounding_box_on_image_array"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_box_on_image_array.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_box_on_image_array">[docs]</a><span class="k">def</span> <span class="nf">draw_bounding_box_on_image_array</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">y_min</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">x_min</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">y_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">x_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_normalized_coordinates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">PilModesEnum</span> <span class="o">=</span> <span class="n">PilModesEnum</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Adds a bounding box to an image (numpy array).</span>

<span class="sd">    Bounding box coordinates can be specified in either absolute (pixel) or</span>
<span class="sd">    normalized coordinates by setting the use_normalized_coordinates argument.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: a numpy array with shape [height, width, 3].</span>
<span class="sd">    y_min: y_min of bounding box.</span>
<span class="sd">    x_min: x_min of bounding box.</span>
<span class="sd">    y_max: y_max of bounding box.</span>
<span class="sd">    x_max: x_max of bounding box.</span>
<span class="sd">    color: color to draw bounding box.</span>
<span class="sd">    thickness: line thickness. Default value is 2.</span>
<span class="sd">    labels: list of strings to display in box</span>
<span class="sd">                (each to be shown on its own line).</span>
<span class="sd">    use_normalized_coordinates: If True (default), treat coordinates</span>
<span class="sd">    y_min, x_min, y_max, x_max as relative to the image.  Otherwise treat</span>
<span class="sd">    coordinates as absolute.&quot;&quot;&quot;</span>

    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">draw_bounding_box_on_image</span><span class="p">(</span>
        <span class="n">image_pil</span><span class="p">,</span>
        <span class="n">y_min</span><span class="p">,</span>
        <span class="n">x_min</span><span class="p">,</span>
        <span class="n">y_max</span><span class="p">,</span>
        <span class="n">x_max</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">,</span>
        <span class="n">line_color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">,</span>
        <span class="n">use_normalized_coordinates</span><span class="o">=</span><span class="n">use_normalized_coordinates</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_pil</span><span class="p">))</span></div>


<div class="viewcode-block" id="draw_bounding_box_on_image"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_box_on_image.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_box_on_image">[docs]</a><span class="k">def</span> <span class="nf">draw_bounding_box_on_image</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span>
    <span class="n">x_min</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span>
    <span class="n">y_min</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span>
    <span class="n">x_max</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span>
    <span class="n">y_max</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">line_color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_normalized_coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">label_inside</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">text_color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a bounding box to an image.</span>

<span class="sd">    Bounding box coordinates can be specified in either absolute (pixel) or</span>
<span class="sd">    normalized coordinates by setting the use_normalized_coordinates argument.</span>

<span class="sd">    Each string in display_str_list is displayed on a separate line above the</span>
<span class="sd">    bounding box in black text on a rectangle filled with the input &#39;color&#39;.</span>
<span class="sd">    If the top of the bounding box extends to the edge of the image, the strings</span>
<span class="sd">    are displayed below the bounding box.</span>

<span class="sd">    Args:</span>
<span class="sd">    :param image: a PIL.Image object.</span>

<span class="sd">    :param x_min: x_min of bounding box.</span>
<span class="sd">    :param y_min: y_min of bounding box.</span>
<span class="sd">    :param x_max: x_max of bounding box.</span>
<span class="sd">    :param y_max: y_max of bounding box.</span>

<span class="sd">    :param line_color: color to draw bounding box.</span>
<span class="sd">    :param thickness: line thickness. Default value is 2.</span>
<span class="sd">    :param labels: list of strings to display in box</span>
<span class="sd">                (each to be shown on its own line).</span>
<span class="sd">    :param use_normalized_coordinates: If True (default), treat coordinates</span>
<span class="sd">    y_min, x_min, y_max, x_max as relative to the image.  Otherwise treat</span>
<span class="sd">    coordinates as absolute.</span>

<span class="sd">    :param label_inside:</span>
<span class="sd">    :param text_color:&quot;&quot;&quot;</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line_color</span><span class="p">:</span>
        <span class="n">line_color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="p">(</span><span class="n">line_color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">line_color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="o">.</span><span class="n">red</span>

    <span class="k">if</span> <span class="n">text_color</span><span class="p">:</span>
        <span class="n">text_color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="p">(</span><span class="n">text_color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line_color</span> <span class="o">==</span> <span class="n">ColorEnum</span><span class="o">.</span><span class="n">white</span><span class="p">:</span>
            <span class="n">text_color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="o">.</span><span class="n">black</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="o">.</span><span class="n">white</span>

    <span class="n">im_width</span><span class="p">,</span> <span class="n">im_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="k">if</span> <span class="n">use_normalized_coordinates</span><span class="p">:</span>
        <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">x_min</span> <span class="o">*</span> <span class="n">im_width</span><span class="p">,</span>
            <span class="n">x_max</span> <span class="o">*</span> <span class="n">im_width</span><span class="p">,</span>
            <span class="n">y_min</span> <span class="o">*</span> <span class="n">im_height</span><span class="p">,</span>
            <span class="n">y_max</span> <span class="o">*</span> <span class="n">im_height</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">)</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
        <span class="p">[(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">bottom</span><span class="p">),</span> <span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">),</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">)],</span>
        <span class="n">width</span><span class="o">=</span><span class="n">thickness</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">line_color</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="s2">&quot;arial.ttf&quot;</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">load_default</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
        <span class="c1"># If the total height of the display strings added to the top of the bounding</span>
        <span class="c1"># box exceeds the top of the image, stack the strings below the bounding box</span>
        <span class="c1"># instead of above.</span>
        <span class="n">display_str_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">font</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
        <span class="n">display_str_width</span><span class="p">,</span> <span class="n">display_str_height</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">display_str_size</span><span class="p">)</span>
        <span class="c1"># Each display_str has a top and bottom margin of 0.05x.</span>
        <span class="n">total_display_str_height</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">display_str_height</span><span class="p">)</span>
        <span class="n">total_display_str_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">display_str_width</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">text_left</span> <span class="o">=</span> <span class="n">right</span> <span class="o">-</span> <span class="n">total_display_str_width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_left</span> <span class="o">=</span> <span class="n">left</span>

        <span class="k">if</span> <span class="n">top</span> <span class="o">&gt;</span> <span class="n">total_display_str_height</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">label_inside</span><span class="p">:</span>
                <span class="n">text_bottom</span> <span class="o">=</span> <span class="n">top</span> <span class="o">+</span> <span class="n">total_display_str_height</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_bottom</span> <span class="o">=</span> <span class="n">top</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_inside</span><span class="p">:</span>
                <span class="n">text_bottom</span> <span class="o">=</span> <span class="n">bottom</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_bottom</span> <span class="o">=</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">total_display_str_height</span>
        <span class="c1"># Reverse list and print from bottom to top.</span>
        <span class="k">for</span> <span class="n">display_str</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">text_width</span><span class="p">,</span> <span class="n">text_height</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">display_str</span><span class="p">)</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">text_height</span><span class="p">)</span>

            <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">(</span><span class="n">text_left</span><span class="p">,</span> <span class="n">text_bottom</span> <span class="o">-</span> <span class="n">text_height</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">),</span>
                    <span class="p">(</span><span class="n">text_left</span> <span class="o">+</span> <span class="n">text_width</span> <span class="o">+</span> <span class="n">margin</span><span class="p">,</span> <span class="n">text_bottom</span><span class="p">),</span>
                <span class="p">],</span>
                <span class="n">fill</span><span class="o">=</span><span class="n">line_color</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="p">(</span><span class="n">text_left</span> <span class="o">+</span> <span class="n">margin</span><span class="p">,</span> <span class="n">text_bottom</span> <span class="o">-</span> <span class="n">text_height</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">),</span>
                <span class="n">display_str</span><span class="p">,</span>
                <span class="n">fill</span><span class="o">=</span><span class="n">text_color</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">text_bottom</span> <span class="o">-=</span> <span class="n">text_height</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span></div>


<div class="viewcode-block" id="draw_bounding_boxes_on_image_array"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_boxes_on_image_array.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_boxes_on_image_array">[docs]</a><span class="k">def</span> <span class="nf">draw_bounding_boxes_on_image_array</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">boxes</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ColorEnum</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">PilModesEnum</span> <span class="o">=</span> <span class="n">PilModesEnum</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Draws bounding boxes on image (numpy array).</span>

<span class="sd">    Args:</span>
<span class="sd">    :param image: a numpy array object.</span>
<span class="sd">    :param boxes: a 2 dimensional numpy array of [N, 4]: (y_min, x_min, y_max, x_max).</span>
<span class="sd">     The coordinates are in normalized format between [0, 1].</span>
<span class="sd">    :param color: color to draw bounding box.</span>
<span class="sd">    :param thickness: line thickness. Default value is 4.</span>
<span class="sd">    :param labels: list of list of strings.</span>
<span class="sd">                     a list of strings for each bounding box.</span>
<span class="sd">                     The reason to pass a list of strings for a</span>
<span class="sd">                     bounding box is that it might contain</span>
<span class="sd">                     multiple labels.</span>
<span class="sd">    :param mode:</span>
<span class="sd">    Raises:</span>
<span class="sd">    ValueError: if boxes is not a [N, 4] array&quot;&quot;&quot;</span>
    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="n">draw_bounding_boxes_on_image</span><span class="p">(</span>
        <span class="n">image_pil</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span>
    <span class="p">)</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_pil</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span></div>


<div class="viewcode-block" id="draw_bounding_boxes_on_image"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_boxes_on_image.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_bounding_boxes_on_image">[docs]</a><span class="k">def</span> <span class="nf">draw_bounding_boxes_on_image</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">boxes</span><span class="p">,</span>
    <span class="n">labels_iterable</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">thickness</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws bounding boxes on image.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: a PIL.Image object.</span>
<span class="sd">    boxes: a 2 dimensional numpy array of [N, 4]: (y_min, x_min, y_max, x_max).</span>
<span class="sd">     The coordinates are in normalized format between [0, 1].</span>
<span class="sd">    color: color to draw bounding box.</span>
<span class="sd">    thickness: line thickness. Default value is 4.</span>
<span class="sd">    labels_iterable: list of list of strings.</span>
<span class="sd">                     a list of strings for each bounding box.</span>
<span class="sd">                     The reason to pass a list of strings for a</span>
<span class="sd">                     bounding box is that it might contain</span>
<span class="sd">                     multiple labels.</span>

<span class="sd">    Raises:</span>
<span class="sd">    ValueError: if boxes is not a [N, 4] array&quot;&quot;&quot;</span>
    <span class="n">boxes_shape</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">color_iter</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">color</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">labels_iterable</span><span class="p">:</span>
            <span class="n">labels_iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">labels_iterable</span><span class="p">)</span>
            <span class="n">color_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">cycle</span><span class="p">([</span><span class="o">*</span><span class="n">ColorEnum</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">ColorEnum</span><span class="o">.</span><span class="n">red</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">boxes_shape</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">boxes_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">boxes_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input must be of size [N, 4]&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boxes_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="n">labels_iterable</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">labels_iterable</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">color_iter</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">color_iter</span><span class="p">)</span>

        <span class="n">draw_bounding_box_on_image</span><span class="p">(</span>
            <span class="n">image</span><span class="p">,</span>
            <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="n">labels</span><span class="p">,</span>
            <span class="n">line_color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">thickness</span><span class="o">=</span><span class="n">thickness</span><span class="p">,</span>
        <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_visualize_boxes</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">category_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">visualize_boxes_and_labels_on_image_array</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">category_index</span><span class="o">=</span><span class="n">category_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_visualize_boxes_and_masks</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">masks</span><span class="p">,</span> <span class="n">category_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">visualize_boxes_and_labels_on_image_array</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">classes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">category_index</span><span class="o">=</span><span class="n">category_index</span><span class="p">,</span>
        <span class="n">instance_masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_visualize_boxes_and_keypoints</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">category_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">visualize_boxes_and_labels_on_image_array</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">classes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">category_index</span><span class="o">=</span><span class="n">category_index</span><span class="p">,</span>
        <span class="n">keypoints</span><span class="o">=</span><span class="n">keypoints</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_visualize_boxes_and_masks_and_keypoints</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">masks</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">category_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">visualize_boxes_and_labels_on_image_array</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">classes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">category_index</span><span class="o">=</span><span class="n">category_index</span><span class="p">,</span>
        <span class="n">instance_masks</span><span class="o">=</span><span class="n">masks</span><span class="p">,</span>
        <span class="n">keypoints</span><span class="o">=</span><span class="n">keypoints</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<div class="viewcode-block" id="draw_keypoints_on_image_array"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_keypoints_on_image_array.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_keypoints_on_image_array">[docs]</a><span class="k">def</span> <span class="nf">draw_keypoints_on_image_array</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">keypoints</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_normalized_coordinates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">PilModesEnum</span> <span class="o">=</span> <span class="n">PilModesEnum</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws keypoints on an image (numpy array).</span>

<span class="sd">    Args:</span>
<span class="sd">    image: a numpy array with shape [height, width, 3].</span>
<span class="sd">    keypoints: a numpy array with shape [num_keypoints, 2].</span>
<span class="sd">    color: color to draw the keypoints with.</span>
<span class="sd">    radius: keypoint radius. Default value is 2.</span>
<span class="sd">    use_normalized_coordinates: if True (default), treat keypoint values as</span>
<span class="sd">    relative to the image.  Otherwise treat them as absolute.</span>
<span class="sd">    :param use_normalized_coordinates:</span>
<span class="sd">    :param radius:</span>
<span class="sd">    :param color:</span>
<span class="sd">    :param keypoints:</span>
<span class="sd">    :param image:</span>
<span class="sd">    :param mode:&quot;&quot;&quot;</span>
    <span class="n">image_pil</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">draw_keypoints_on_image</span><span class="p">(</span>
        <span class="n">image_pil</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">use_normalized_coordinates</span>
    <span class="p">)</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image_pil</span><span class="p">))</span></div>


<div class="viewcode-block" id="draw_keypoints_on_image"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_keypoints_on_image.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_keypoints_on_image">[docs]</a><span class="k">def</span> <span class="nf">draw_keypoints_on_image</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">keypoints</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">radius</span><span class="p">:</span> <span class="n">Number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">use_normalized_coordinates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="c1"># TODO: ADD LABELS</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws keypoints on an image.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: a PIL.Image object.</span>
<span class="sd">    keypoints: a numpy array with shape [num_keypoints, 2].</span>
<span class="sd">    color: color to draw the keypoints with.</span>
<span class="sd">    radius: keypoint radius. Default value is 2.</span>
<span class="sd">    use_normalized_coordinates: if True (default), treat keypoint values as</span>
<span class="sd">    relative to the image.  Otherwise treat them as absolute.&quot;&quot;&quot;</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">im_width</span><span class="p">,</span> <span class="n">im_height</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span>
    <span class="n">keypoints_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keypoints</span><span class="p">]</span>
    <span class="n">keypoints_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keypoints</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">use_normalized_coordinates</span><span class="p">:</span>
        <span class="n">keypoints_x</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">im_width</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">keypoints_x</span><span class="p">])</span>
        <span class="n">keypoints_y</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">im_height</span> <span class="o">*</span> <span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">keypoints_y</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">keypoint_x</span><span class="p">,</span> <span class="n">keypoint_y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keypoints_x</span><span class="p">,</span> <span class="n">keypoints_y</span><span class="p">):</span>
        <span class="n">draw</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">keypoint_x</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">keypoint_y</span> <span class="o">-</span> <span class="n">radius</span><span class="p">),</span>
                <span class="p">(</span><span class="n">keypoint_x</span> <span class="o">+</span> <span class="n">radius</span><span class="p">,</span> <span class="n">keypoint_y</span> <span class="o">+</span> <span class="n">radius</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">outline</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="draw_mask_on_image_array"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_mask_on_image_array.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.draw_mask_on_image_array">[docs]</a><span class="k">def</span> <span class="nf">draw_mask_on_image_array</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">mask</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">ColorEnum</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">PilModesEnum</span> <span class="o">=</span> <span class="n">PilModesEnum</span><span class="o">.</span><span class="n">RGBA</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws mask on an image.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: uint8 numpy array with shape (img_height, img_height, 3)</span>
<span class="sd">    mask: a uint8 numpy array of shape (img_height, img_height) with</span>
<span class="sd">    values between either 0 or 1.</span>
<span class="sd">    color: color to draw the keypoints with.</span>
<span class="sd">    alpha: transparency value between 0 and 1. (default: 0.4)</span>

<span class="sd">    Raises:</span>
<span class="sd">    ValueError: On incorrect data type for image or masks.</span>
<span class="sd">    :param alpha:</span>
<span class="sd">    :param color:</span>
<span class="sd">    :param mask:</span>
<span class="sd">    :param image:</span>
<span class="sd">    :param mode:&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`image` not of type numpy.uint8&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`mask` not of type numpy.uint8&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">mask</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mask</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`mask` elements should be in [0, 1]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The image has spatial dimensions </span><span class="si">%s</span><span class="s2"> but the mask has &quot;</span>
            <span class="s2">&quot;dimensions </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="n">rgb</span> <span class="o">=</span> <span class="n">ImageColor</span><span class="o">.</span><span class="n">getrgb</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">pil_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>

    <span class="n">solid_color</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">rgb</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">pil_solid_color</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">solid_color</span><span class="p">))</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGBA&quot;</span><span class="p">)</span>
    <span class="n">pil_mask</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="mf">255.0</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">mask</span><span class="p">))</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span>
    <span class="n">pil_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">composite</span><span class="p">(</span><span class="n">pil_solid_color</span><span class="p">,</span> <span class="n">pil_image</span><span class="p">,</span> <span class="n">pil_mask</span><span class="p">)</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">copyto</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pil_image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">mode</span><span class="p">)))</span></div>


<div class="viewcode-block" id="visualize_boxes_and_labels_on_image_array"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.visualize_boxes_and_labels_on_image_array.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.visualize_boxes_and_labels_on_image_array">[docs]</a><span class="k">def</span> <span class="nf">visualize_boxes_and_labels_on_image_array</span><span class="p">(</span>
    <span class="n">image</span><span class="p">,</span>
    <span class="n">bounding_boxes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BoundingBoxSpec</span><span class="p">],</span>
    <span class="n">use_normalized_coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">max_boxes_to_draw</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">min_score_thresh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">line_thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overlay labeled boxes on an image with formatted scores and label names.</span>

<span class="sd">    This function groups boxes that correspond to the same location</span>
<span class="sd">    and creates a display string for each detection and overlays these</span>
<span class="sd">    on the image. Note that this function modifies the image in place, and returns</span>
<span class="sd">    that same image.</span>

<span class="sd">    Args:</span>
<span class="sd">    image: uint8 numpy array with shape (img_height, img_width, 3)</span>
<span class="sd">    boxes: a numpy array of shape [N, 4]</span>
<span class="sd">    classes: a numpy array of shape [N]. Note that class indices are 1-based,</span>
<span class="sd">    and match the keys in the label map.</span>
<span class="sd">    scores: a numpy array of shape [N] or None.  If scores=None, then</span>
<span class="sd">    this function assumes that the boxes to be plotted are groundtruth</span>
<span class="sd">    boxes and plot all boxes as black with no classes or scores.</span>
<span class="sd">    category_index: a dict containing category dictionaries (each holding</span>
<span class="sd">    category index `id` and category name `name`) keyed by category indices.</span>
<span class="sd">    instance_masks: a numpy array of shape [N, image_height, image_width] with</span>
<span class="sd">    values ranging between 0 and 1, can be None.</span>
<span class="sd">    instance_boundaries: a numpy array of shape [N, image_height, image_width]</span>
<span class="sd">    with values ranging between 0 and 1, can be None.</span>
<span class="sd">    keypoints: a numpy array of shape [N, num_keypoints, 2], can</span>
<span class="sd">    be None</span>
<span class="sd">    use_normalized_coordinates: whether boxes is to be interpreted as</span>
<span class="sd">    normalized coordinates or not.</span>
<span class="sd">    max_boxes_to_draw: maximum number of boxes to visualize.  If None, draw</span>
<span class="sd">    all boxes.</span>
<span class="sd">    min_score_thresh: minimum score threshold for a box to be visualized</span>
<span class="sd">    agnostic_mode: boolean (default: False) controlling whether to evaluate in</span>
<span class="sd">    class-agnostic mode or not.  This mode will display scores but ignore</span>
<span class="sd">    classes.</span>
<span class="sd">    line_thickness: integer (default: 2) controlling line width of the boxes.</span>
<span class="sd">    groundtruth_box_visualization_color: box color for visualizing groundtruth</span>
<span class="sd">    boxes</span>
<span class="sd">    skip_scores: whether to skip score when drawing a single detection</span>
<span class="sd">    skip_labels: whether to skip label when drawing a single detection</span>

<span class="sd">    Returns:</span>
<span class="sd">    uint8 numpy array with shape (img_height, img_width, 3) with overlaid boxes.</span>
<span class="sd">    :param image:</span>
<span class="sd">    :type image:</span>
<span class="sd">    :param use_normalized_coordinates:</span>
<span class="sd">    :type use_normalized_coordinates:</span>
<span class="sd">    :param max_boxes_to_draw:</span>
<span class="sd">    :type max_boxes_to_draw:</span>
<span class="sd">    :param min_score_thresh:</span>
<span class="sd">    :type min_score_thresh:</span>
<span class="sd">    :param line_thickness:</span>
<span class="sd">    :type line_thickness:</span>
<span class="sd">    :param bounding_boxes:&quot;&quot;&quot;</span>
    <span class="c1"># Create a display string (and color) for every box location, group any boxes</span>
    <span class="c1"># that correspond to the same location.</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">max_boxes_to_draw</span><span class="p">:</span>
        <span class="n">max_boxes_to_draw</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounding_boxes</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">max_boxes_to_draw</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bounding_boxes</span><span class="p">))):</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">bounding_boxes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
        <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">STANDARD_COLORS</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">STANDARD_COLORS</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">score</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">box</span><span class="o">.</span><span class="n">score</span> <span class="o">&gt;</span> <span class="n">min_score_thresh</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">draw_mask_on_image_array</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

            <span class="n">draw_bounding_box_on_image_array</span><span class="p">(</span>
                <span class="n">image</span><span class="p">,</span>
                <span class="o">*</span><span class="n">box</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                <span class="n">thickness</span><span class="o">=</span><span class="n">line_thickness</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                <span class="n">use_normalized_coordinates</span><span class="o">=</span><span class="n">use_normalized_coordinates</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">keypoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">draw_keypoints_on_image_array</span><span class="p">(</span>
                    <span class="n">image</span><span class="p">,</span>
                    <span class="n">box</span><span class="o">.</span><span class="n">keypoints</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">box</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">radius</span><span class="o">=</span><span class="n">line_thickness</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">use_normalized_coordinates</span><span class="o">=</span><span class="n">use_normalized_coordinates</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">image</span></div>


<div class="viewcode-block" id="hist_plot"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.hist_plot.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.hist_plot">[docs]</a><span class="k">def</span> <span class="nf">hist_plot</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numpy function to plot hist.&quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">tostring_rgb</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span></div>


<div class="viewcode-block" id="cdf_plot"><a class="viewcode-back" href="../../../../generated/neodroidvision.utilities.visualisation.bounding_box_visualisation.cdf_plot.html#neodroidvision.utilities.visualisation.bounding_box_visualisation.cdf_plot">[docs]</a><span class="k">def</span> <span class="nf">cdf_plot</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Numpy function to plot CDF.&quot;&quot;&quot;</span>
    <span class="n">normalized_values</span> <span class="o">=</span> <span class="n">values</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">sorted_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">normalized_values</span><span class="p">)</span>
    <span class="n">cumulative_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sorted_values</span><span class="p">)</span>
    <span class="n">fraction_of_examples</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cumulative_values</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="o">/</span> <span class="n">cumulative_values</span><span class="o">.</span><span class="n">size</span>
    <span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s2">&quot;111&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fraction_of_examples</span><span class="p">,</span> <span class="n">cumulative_values</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;cumulative normalized values&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;fraction of examples&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">tostring_rgb</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">image</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">labels_str</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),)</span>

        <span class="n">draw_bounding_boxes_on_image_array</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">labels_str</span><span class="p">)</span>
        <span class="c1"># bs = [BoundingBoxSpec(bb_,l_,None,None,None,&#39;white&#39;) for bb_, l_ in zip(bb,labels_str)]</span>

        <span class="c1"># visualize_boxes_and_labels_on_image_array(im, bs)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">main2</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">labels_str</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),)</span>

        <span class="n">draw_bounding_boxes_on_image_array</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">labels_str</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PilModesEnum</span><span class="o">.</span><span class="n">RGB</span><span class="p">)</span>
        <span class="c1"># bs = [BoundingBoxSpec(bb_,l_,None,None,None,&#39;white&#39;) for bb_, l_ in zip(bb,labels_str)]</span>

        <span class="c1"># visualize_boxes_and_labels_on_image_array(im, bs)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">main3</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">labels_str</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),)</span>

        <span class="n">draw_bounding_boxes_on_image_array</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">labels_str</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PilModesEnum</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="c1"># bs = [BoundingBoxSpec(bb_,l_,None,None,None,&#39;white&#39;) for bb_, l_ in zip(bb,labels_str)]</span>

        <span class="c1"># visualize_boxes_and_labels_on_image_array(im, bs)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">main2</span><span class="p">()</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/header.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../../index.html">neodroidvision</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../generated/neodroidvision.html">neodroidvision</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  <li><a href="../../../neodroidvision.html">neodroidvision</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>